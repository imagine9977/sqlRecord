<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
"-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper
	namespace="com.sqlrecord.sqlrecord.qna.model.dao.QnaMapper">
	<sql id="selectQna">
		SELECT
		QNA_NO qnaNo,
		SECRET secret,
		QNA_TITLE qnaTitle,
		CATEGORY qnaCategory,
		QNA_CONTENT qnaContent,
		SOLVED solved,
		COUNT count,
		to_char(CREATE_DATE,'yyyy-mm-dd') createDate,
		to_char(CHANGE_DATE,'yyyy-mm-dd') changeDate,
		DELSTATUS delStatus,
		QNA_WRITER_NO memberNo
		FROM
		QNA
		WHERE
			DELSTATUS='Y'
	</sql>
	<select id="findAll" resultType="qna">
		
		SELECT
		QNA_NO qnaNo,
		SECRET secret,
		QNA_TITLE qnaTitle,
		CATEGORY qnaCategory,
		QNA_CONTENT qnaContent,
		SOLVED solved,
		COUNT count,
		to_char(CREATE_DATE,'yyyy-mm-dd') createDate,
		to_char(CHANGE_DATE,'yyyy-mm-dd') changeDate,
		DELSTATUS delStatus,
		QNA_WRITER_NO memberNo
		FROM(
			SELECT
				QNA_NO ,
				SECRET ,
				QNA_TITLE ,
				CATEGORY ,
				QNA_CONTENT ,
				SOLVED ,
				COUNT ,
				CREATE_DATE,
				CHANGE_DATE ,
				DELSTATUS ,
				QNA_WRITER_NO ,
				ROWNUM RNUM
			FROM(
				SELECT
					QNA_NO ,
					SECRET ,
					QNA_TITLE ,
					CATEGORY ,
					QNA_CONTENT ,
					SOLVED ,
					COUNT ,
					CREATE_DATE,
					CHANGE_DATE ,
					DELSTATUS ,
					QNA_WRITER_NO 
				FROM
					QNA
				WHERE
					DELSTATUS='Y'
				ORDER
					BY
						QNA_NO DESC) )
		
		WHERE
			ROWNUM BETWEEN #{startValue} AND #{endValue}
	</select>
	<select id="findByCate" 
		resultType="qna">

		SELECT
		QNA_NO qnaNo,
		SECRET secret,
		QNA_TITLE qnaTitle,
		CATEGORY qnaCategory,
		QNA_CONTENT qnaContent,
		SOLVED solved,
		COUNT count,
		to_char(CREATE_DATE,'yyyy-mm-dd') createDate,
		to_char(CHANGE_DATE,'yyyy-mm-dd') changeDate,
		DELSTATUS delStatus,
		QNA_WRITER_NO memberNo
		FROM(
			SELECT
				QNA_NO ,
				SECRET ,
				QNA_TITLE ,
				CATEGORY ,
				QNA_CONTENT ,
				SOLVED ,
				COUNT ,
				CREATE_DATE,
				CHANGE_DATE ,
				DELSTATUS ,
				QNA_WRITER_NO ,
				ROWNUM RNUM
			FROM(
				SELECT
					QNA_NO ,
					SECRET ,
					QNA_TITLE ,
					CATEGORY ,
					QNA_CONTENT ,
					SOLVED ,
					COUNT ,
					CREATE_DATE,
					CHANGE_DATE ,
					DELSTATUS ,
					QNA_WRITER_NO 
				FROM
					QNA
				WHERE
					DELSTATUS='Y'
					AND
						CATEGORY=#{cate}
				ORDER
					BY
						QNA_NO DESC) )
		
		WHERE
			ROWNUM BETWEEN #{startValue} AND #{endValue}
	</select>
	<select id="qnaCount" resultType="_int">
		SELECT
		COUNT(QNA_NO)
		FROM
		QNA
		WHERE
		DELSTATUS='Y'

	</select>
	</mapper>