<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sqlrecord.sqlrecord.cart.model.dao.CartMapper">

	<resultMap type="cart" id="cartRM">
    	<id property="cart_num" column="cart_num"/>
	    <result property="cart_amount" column="cart_amount" jdbcType="INTEGER"/>
	    <association property="member" javaType="member">
	    	<id property="memberNo" column="MEMBER_ID"/>
		    <result property="memberId" column="MEMBER_ID"/>
		    <result property="memberPw" column="MEMBER_PW"/>
		    <result property="name" column="NAME"/>
		    <result property="email" column="EMAIL"/>
		    <result property="tell" column="TELL"/>
		    <result property="addr1" column="ADDR1"/>
		    <result property="addr2" column="ADDR2"/>
		    <result property="postcode" column="POSTCODE"/>
		    <result property="birth" column="BIRTH"/>
		    <result property="point" column="POINT"/>
		    <result property="status" column="STATUS"/>
		    <result property="resDate" column="RES_DATE"/>
    	</association>  
    	<association property="product" javaType="com.sqlrecord.sqlrecord.orders.model.vo.Product">
	        <result property="product_no" column="PRODUCT_NO"/>
	        <result property="product_name" column="PRODUCT_NAME"/>
	        <result property="product_price" column="PRODUCT_PRICE"/>
	        <result property="product_status" column="PRODUCT_STATUS"/>
	        <result property="product_date" column="PRODUCT_DATE"/>
	        <result property="tag_no" column="tag_no"/>
	        <result property="product_detail" column="product_detail"/>
	        <result property="product_cate" column="product_cate"/>
	        <result property="color" column="color"/>
	        <association property="product_photos" javaType="product_photos">
	        	<result property="photo_no" column="PHOTO_NO"/>
			    <result property="product_no" column="PRODUCT_NO"/>
			    <result property="photo_name" column="PHOTO_NAME"/>
			    <result property="photo_path" column="PHOTO_PATH"/>
	        </association>
	    </association>
	</resultMap>

	<resultMap type="guestCart" id="guestCartRM">
    	<id property="guest_cart_num" column="cart_num"/>
    	<result property="guest_no" column="guest_no"/>  
	    <result property="guest_cart_amount" column="guest_cart_amount" jdbcType="INTEGER"/>
    	<association property="product" javaType="com.sqlrecord.sqlrecord.orders.model.vo.Product">
	        <result property="product_no" column="product_no"/>
	        <result property="product_name" column="product_name"/>
	        <result property="product_price" column="product_price"/>
	        <result property="product_status" column="product_status"/>
	        <result property="product_date" column="product_date"/>
			

	        <result property="tag_no" column="tag_no"/>
	        <result property="product_detail" column="product_detail"/>
	        <result property="product_cate" column="product_cate"/>
	        <result property="color" column="color"/>
	    </association>
	</resultMap>

	<select id="cartListSelect" parameterType="_int" resultMap="cartRM">
	 SELECT
			c.PRODUCT_NO,
			c.MEMBER_NO,
			c.CART_AMOUNT,
			p.PRODUCT_NAME,
			p.PRODUCT_PRICE,
			ps.photo_no,
			ps.photo_name,
			ps.photo_path
	   FROM
			MEMBER_CART c
	   JOIN
			PRODUCT p
		 ON
			c.PRODUCT_NO = p.PRODUCT_NO
	   JOIN
	   		PRODUCT_PHOTOS ps
	   	ON	
	   		p.PRODUCT_NO = ps.PRODUCT_NO
	  WHERE
			c.MEMBER_NO = #{member_no}
	  ORDER
		 BY
 			c.CART_NUM
	   DESC
	
	
	</select>
	
	<select id="guestCartListSelect" parameterType="_int" resultMap="guestCartRM">
	 SELECT
			c.PRODUCT_NO,
			c.GUEST_NO,
			c.GUEST_CART_AMOUNT,
			p.PRODUCT_PRICE,
			p.PRODUCT_PHOTO1,
			p.PRODUCT_NAME
	   FROM
			GUEST_CART c
	   JOIN
			PRODUCT p
		 ON
			c.PRODUCT_NO = p.PRODUCT_NO
	  WHERE
			c.GUEST_NO = #{GUEST_no}
	  ORDER
		 BY
 			c.GUEST_CART_NUM
	   DESC
	
	
	</select>

</mapper>